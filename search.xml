<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>Trac-NoPreview Chrome Extension</title>
      <link href="/2019/05/07/Chrome-Extensions/"/>
      <url>/2019/05/07/Chrome-Extensions/</url>
      
        <content type="html"><![CDATA[<h2 id="WHY-为什么要做"><a href="#WHY-为什么要做" class="headerlink" title="WHY 为什么要做"></a>WHY 为什么要做</h2><p>公司用<a href="https://trac.edgewall.org/" target="_blank" rel="noopener">Trac</a>作为管理系统。修改Ticket，或者提交工作日志时，总需要先预览才能提交（应该是有权限的人设置的），为了方便自己使用，就花了点时间写了一个浏览器插件，可以不经过预览就提交，顺便学习下<code>Chrome</code>插件的开发。</p><h2 id="HOW-怎么做"><a href="#HOW-怎么做" class="headerlink" title="HOW 怎么做"></a>HOW 怎么做</h2><p>先研究下不用插件怎么实现，现在的情况是不<code>Preview</code>的话，<code>Submit changes</code>的按钮是灰色的，嗯那就应该只是将按钮设为disable了。嗯F12，去掉<code>disabled</code>果然可以直接提交了。那么现在插件要做的事情只是将<code>disabled</code>设为<code>false</code>就可以了。然后查看几个页面发现他们有共同的<code>class=&quot;trac-disable-on-submit&quot;</code>.</p><p><img src="https://i.ibb.co/Gkvvzzf/trac-nopreview.png" alt="IMG"></p><p>然后我们来看看<code>Chrome</code>插件的官方文档。概述 <a href="https://developer.chrome.com/extensions/overview" target="_blank" rel="noopener">overview(可能需要穿越屏障)</a>.</p><p>简单来说分为以下几个部分</p><ul><li>Manifest : 指定图标，脚本文件位置，插件描述（版本，作者）</li><li>Background Script : 后台脚本（目前没用到）</li><li>UI Elements : 插件的页面，可简单,可复杂</li><li>Content Script ： 要执行的 <code>javaScript</code> 代码</li><li>Options Page ： 插件的配置页面（目前没用到）</li></ul><p>上述内容，对照着图更好理解（放到了自己的图床上，应该都可以看到了）</p><p><img src="https://i.ibb.co/0CksY7k/contentscriptarc.png" alt="IMG"></p><h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>内容并不多，就把所以代码都粘上来了。</p><h3 id="manifest-json"><a href="#manifest-json" class="headerlink" title="manifest.json"></a>manifest.json</h3><figure class="highlight json"><figcaption><span>manifest.json</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"manifest_version"</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"Trac-NoPreview"</span>,</span><br><span class="line">  <span class="attr">"version"</span>: <span class="string">"1.0.0.0"</span>,</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"For Trac No Preview Submit"</span>,</span><br><span class="line">  <span class="attr">"icons"</span>: &#123;</span><br><span class="line">    <span class="attr">"16"</span>: <span class="string">"images/trac16.png"</span>,</span><br><span class="line">    <span class="attr">"32"</span>: <span class="string">"images/trac32.png"</span>,</span><br><span class="line">    <span class="attr">"48"</span>: <span class="string">"images/trac48.png"</span>,</span><br><span class="line">    <span class="attr">"128"</span>: <span class="string">"images/trac128.png"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"browser_action"</span>: &#123;</span><br><span class="line">    <span class="attr">"default_icon"</span>: &#123;</span><br><span class="line">      <span class="attr">"16"</span>: <span class="string">"images/trac16.png"</span>,</span><br><span class="line">      <span class="attr">"32"</span>: <span class="string">"images/trac32.png"</span>,</span><br><span class="line">      <span class="attr">"48"</span>: <span class="string">"images/trac48.png"</span>,</span><br><span class="line">      <span class="attr">"128"</span>: <span class="string">"images/trac128.png"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"default_popup"</span>: <span class="string">"index.html"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">"permissions"</span>: [</span><br><span class="line">    <span class="string">"activeTab"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"content_scripts"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"matches"</span>: [</span><br><span class="line">        <span class="string">"https://trac.edgewall.org/*"</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"js"</span>: [</span><br><span class="line">        <span class="string">"contentScript.js"</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"author"</span>: <span class="string">"Alec.Ji"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>应该只有<code>permissions</code> ，<code>content_scripts</code> 这两部分不是能直接感受，单独说下，其他都好理解。</p><ul><li><p>permissions:activeTab  允许插件访问当前活动的选项卡，具体的可查看<a href="https://developer.chrome.com/extensions/activeTab" target="_blank" rel="noopener">https://developer.chrome.com/extensions/activeTab</a></p></li><li><p>content_scripts</p><ul><li>matches 匹配该url 时才会执行js</li><li>js 指定contentScript位置</li></ul></li></ul><h3 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h3><figure class="highlight html"><figcaption><span>index.html</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images/trac128.png"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>By Alec.ji<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"images/Wechat.png"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="contentScript-js"><a href="#contentScript-js" class="headerlink" title="contentScript.js"></a>contentScript.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> elements = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"trac-disable-on-submit"</span>);</span><br><span class="line"><span class="keyword">if</span> (elements.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    elements[<span class="number">0</span>].disabled = <span class="literal">false</span>;</span><br><span class="line">    elements[<span class="number">0</span>].value += <span class="string">"(Trac-NoPreview)"</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"Trac-NoPreview Success"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Install-安装方法"><a href="#Install-安装方法" class="headerlink" title="Install 安装方法"></a>Install 安装方法</h2><ol><li>用Chrome访问 <a href="chrome://extensions/" target="_blank" rel="noopener">chrome://extensions/</a> 或者用 Edge(chrome内核)访问 <a href="edge://extensions/" target="_blank" rel="noopener">edge://extensions/</a></li><li>打开开发者模式</li><li>选择加载已解压的扩展程序，选择 <code>Trac-NoPreview</code> 文件夹，确认即可</li><li>打开一个<code>Ticket</code>的页面，看看效果。</li></ol><p><img src="https://i.ibb.co/Yp5DSxk/trac-nopreview3.png" alt="IMG"> 懂我的意思吧 :smile: ，等我攒够了钱我就提交到chrome 商店（感谢 X，呼呼小笼包，R，一只鱼 的打赏）。</p><h2 id="Result"><a href="#Result" class="headerlink" title="Result"></a>Result</h2><p>效果如图，已经好用了</p><p><img src="https://i.ibb.co/VvGTrSh/trac-nopewview2.png" alt="IMG"></p><h2 id="还想要实现的"><a href="#还想要实现的" class="headerlink" title="还想要实现的"></a>还想要实现的</h2><ul><li><p>支持登录，跟踪 <code>Ticket</code></p></li><li><p>提醒写日志</p></li><li><p>批量处理<code>ticket</code>, 修改状态，<code>owner</code></p></li><li><p>…</p></li></ul><h2 id="一点小感悟"><a href="#一点小感悟" class="headerlink" title="一点小感悟"></a>一点小感悟</h2><p>经过自己学习开发才知道，chrome插件的强大，便利的同时，也感觉到了危险，如果给了足够的权限，插件能做的事情相当多，所以对于不确认安全的还是要慎用。</p><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><ul><li>官方文档 <a href="https://developer.chrome.com/extensions" target="_blank" rel="noopener">https://developer.chrome.com/extensions</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> Chrome Extensions </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Chrome Extensions </tag>
            
            <tag> Trac </tag>
            
            <tag> Javascript </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Postman 进阶使用技巧</title>
      <link href="/2019/01/27/Postman-advanced-use-method/"/>
      <url>/2019/01/27/Postman-advanced-use-method/</url>
      
        <content type="html"><![CDATA[<p>由于工作中涉及到 <code>API</code> 的开发，以及第三方的对接，<code>Postman</code> 总是少不了使用的，除了简单的发请求，也发现了 <code>Postman</code> 自带的可以用到的功能，做个记录，避免再花时间学习。</p><hr><blockquote><p><strong>Postman makes API development faster, easier, and better</strong></p></blockquote><h2 id="Pre-request-scripts"><a href="#Pre-request-scripts" class="headerlink" title="Pre-request scripts"></a>Pre-request scripts</h2><blockquote><p>Pre-request scripts are snippets of code associated with a collection request that are executed before the request is sent. This is perfect for use-cases like including the timestamp in the request headers or sending a random alphanumeric string in the URL parameters.</p></blockquote><p>简单来说 <code>Pre-request scripts</code> 就是一个请求前的代码(<code>JavaScript</code>)片段。对于在请求头中包含 <code>时间戳</code> 或在 <code>URL</code> 参数中发送随机 <code>字母数字</code> 字符串的情况（<em>当然也可以是更复杂的，可以看下面的例子</em>），易用且好用。</p><h3 id="Pre-request-scripts-Example"><a href="#Pre-request-scripts-Example" class="headerlink" title="Pre-request scripts Example"></a>Pre-request scripts Example</h3><p>比如，请求的接口需要传一个 <code>Base64(APPID + 时间戳)</code> 的 <code>token</code></p><figure class="highlight js"><figcaption><span>Pre-request</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> timestamp = <span class="built_in">Math</span>.round(<span class="keyword">new</span> <span class="built_in">Date</span>().getTime()/<span class="number">1000</span>);  <span class="comment">//时间戳</span></span><br><span class="line"><span class="keyword">var</span> appid = <span class="string">"test"</span>;</span><br><span class="line"><span class="keyword">var</span> secret = <span class="string">"dswybs"</span>;</span><br><span class="line"><span class="keyword">var</span> str = appid + secret + timestamp;</span><br><span class="line"><span class="built_in">console</span>.log(str);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> hash = CryptoJS.SHA256(str);    <span class="comment">//CryptoJS</span></span><br><span class="line"><span class="keyword">var</span> strEnc = hash.toString();</span><br><span class="line"><span class="built_in">console</span>.log(strEnc);</span><br><span class="line"></span><br><span class="line">pm.environment.set(<span class="string">"token"</span>, strEnc);    <span class="comment">//添加环境变量，不同版本可能此处语句不同。</span></span><br><span class="line">pm.globals.set(<span class="string">"appid"</span>, appid);     <span class="comment">//添加全局变量，不同版本可能此处语句不同。</span></span><br></pre></td></tr></table></figure><ul><li><a href="https://code.google.com/p/crypto-js/" target="_blank" rel="noopener"><code>CryptoJS</code></a> Postman常用的库之一。支持主流的加密算法. 如 <code>AES</code>，<code>DES</code> ， <code>HMAC-MD5</code> ， <code>HMAC-SHA1 / 3/256/512</code> ，<code>MD5</code> 等</li></ul><p>效果如图<br><img src="https://i.ibb.co/T0QG22c/Postman-Pre-request1.png" alt="IMG"><br><img src="https://i.ibb.co/h1NPNb4/Postman-Pre-request2.png" alt="IMG"></p><ul><li><code>Ctrl + Alt + C</code> 可以显示出 <code>Postman</code> 的控制台（查看log，以及 <code>HTTP</code> 报文），方便观察结果，建议打开，当然有需要的话，开个 <code>Fiddler</code> 是更好的了。</li></ul><p>除了<code>CryptoJS</code>,<strong>Postman</strong> 还支持 <a href="https://lodash.com/" target="_blank" rel="noopener"><code>Lodash</code></a> , <a href="https://cheerio.js.org/" target="_blank" rel="noopener"><code>cheerio</code></a> 等.</p><h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><p>和 <code>Pre-request scripts</code> 刚好相反， <code>Test</code> 是请求后执行的代码(<code>JavaScript</code>)，用来测试请求的响应是否符合需求。比如，查看 <code>Http Status Code(HTTP 状态码)</code> , <code>响应时间</code>  甚至是 <code>response content(响应的内容)</code> 。借用下官方的图。</p><p><img src="https://s3.amazonaws.com/postman-static-getpostman-com/postman-docs/WS-randomFullTests2.png" alt="IMG"></p><h3 id="Test-Example"><a href="#Test-Example" class="headerlink" title="Test Example"></a>Test Example</h3><p>为了做测试，特意写了一个 <code>API</code> (实际是<code>.NET Core 3.0</code> 出了，想试一下，一行代码搞定，真香)</p><figure class="highlight ps"><figcaption><span>console</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet new webapi -o TodoApi</span><br><span class="line">code -r TodoApi</span><br></pre></td></tr></table></figure><p>简单的写了一个 <code>response</code></p><p><img src="https://i.ibb.co/Lr3kqtd/API-response.png" alt="IMG"></p><p>针对性的写一些，测试语句</p><figure class="highlight js"><figcaption><span>Test Script</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> jsonData = pm.response.json();</span><br><span class="line"><span class="built_in">console</span>.log(jsonData.id);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 状态码</span></span><br><span class="line">pm.test(<span class="string">"Status code is 200"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    pm.response.to.have.status(<span class="number">200</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应时间</span></span><br><span class="line">pm.test(<span class="string">"Response time is less than 200ms"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    pm.expect(pm.response.responseTime).to.be.below(<span class="number">200</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// response content</span></span><br><span class="line">pm.test(<span class="string">"by JICHAO"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    pm.expect(jsonData.type).to.eql(<span class="string">"JICHAO Postman-advanced-use-method"</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>测试结果如下图</p><p><img src="https://i.ibb.co/HhCj054/Postman-test.png" alt="IMG"></p><p>这样就可以清晰的看到结果了，不需要再自己看返回值，判断是否正确。</p><hr><p>Q : 可能看到这就有人要问了，上边的两个是很有用，但是实际的业务是多个请求，每个请求都要再点一下 <code>Send</code> 岂不是很累？</p><p>A : 好问题好问题，这就是我们接下来要看的功能了。</p><hr><h2 id="Collections"><a href="#Collections" class="headerlink" title="Collections"></a>Collections</h2><p>先看下官方的说明</p><blockquote><p>A Postman Collection lets you group individual requests together. You can organize these requests into folders.</p></blockquote><p>简单来说，就是多个请求按照一定顺序组合在一起就是 <code>Collections</code> 了</p><h3 id="Collections-Example"><a href="#Collections-Example" class="headerlink" title="Collections Example"></a>Collections Example</h3><p>一个实际的例子，比如你有烤鱼店的储值卡，当你结账时需要报你的卡号或者手机号，然后老版会查下你有多少钱，是否有会员价（查询接口），然后支付（支付接口）</p><h4 id="查询接口"><a href="#查询接口" class="headerlink" title="查询接口"></a>查询接口</h4><p>Pre-request scripts</p><figure class="highlight js"><figcaption><span>Pre-request scripts</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//测试卡号池，当然也可以设置为从文件中读取</span></span><br><span class="line"><span class="keyword">var</span> cardArr = [</span><br><span class="line"><span class="string">"0123456"</span>,</span><br><span class="line"><span class="string">"0123457"</span>,</span><br><span class="line"><span class="string">"0123458"</span>,</span><br><span class="line">...,</span><br><span class="line"><span class="string">"0123555"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">//随机取一个卡号，作为环境变量</span></span><br><span class="line"><span class="keyword">var</span> cardNo = cardArr[<span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random()*<span class="number">100</span>)];</span><br><span class="line">pm.environment.set(<span class="string">"cardNo"</span>, cardNo);</span><br></pre></td></tr></table></figure><p>Test scripts</p><figure class="highlight js"><figcaption><span>Test scripts</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//Status code</span></span><br><span class="line">pm.test(<span class="string">"Status code is 200"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    pm.response.to.have.status(<span class="number">200</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Response time</span></span><br><span class="line">pm.test(<span class="string">"Response time is less than 999ms"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    pm.expect(pm.response.responseTime).to.be.below(<span class="number">999</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> jsonData = pm.response.json();</span><br><span class="line"><span class="built_in">console</span>.log(jsonData.CardNumber)</span><br><span class="line"></span><br><span class="line"><span class="comment">//取当前卡的余额 * 0.8，作为环境变量，支付用</span></span><br><span class="line"><span class="keyword">var</span> amount = jsonData.money * <span class="number">0.8</span>;</span><br><span class="line">pm.environment.set(<span class="string">"amount"</span>, amount);</span><br><span class="line"><span class="built_in">console</span>.log(amount)</span><br></pre></td></tr></table></figure><h4 id="支付接口"><a href="#支付接口" class="headerlink" title="支付接口"></a>支付接口</h4><p>Body</p><figure class="highlight"><figcaption><span>Body</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"cardNumber"</span>: <span class="string">"&#123;&#123;cardNo&#125;&#125;"</span>,</span><br><span class="line">    <span class="attr">"password"</span>: <span class="string">"****"</span>,</span><br><span class="line">    <span class="attr">"amount"</span>: <span class="string">"&#123;&#123;amount&#125;&#125;"</span>,</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此处的 <code> {{}} </code> 说明是变量，括号中的内容为变量名。</p><p>Test scripts</p><figure class="highlight js"><figcaption><span>Test scripts</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//Status code</span></span><br><span class="line">pm.test(<span class="string">"Status code is 200"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    pm.response.to.have.status(<span class="number">200</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Response time</span></span><br><span class="line">pm.test(<span class="string">"Response time is less than 3000ms"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    pm.expect(pm.response.responseTime).to.be.below(<span class="number">3000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算余额是否正确</span></span><br><span class="line"><span class="keyword">var</span> balance = pm.variables.get(<span class="string">"balance"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> jsonData = pm.response.json();</span><br><span class="line">pm.test(<span class="string">"扣款不正确"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    pm.expect(jsonData.lastBalance - jsonData.balance).to.eql(amount);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>做完这些准备工作就可以，设置一个 <code>Collection</code> 并运行它了。设置项，有如下几项，<a href="https://learning.getpostman.com/docs/postman/collection_runs/starting_a_collection_run/" target="_blank" rel="noopener">官方文档</a>描述的更为详细，此处就不展开说了.<strong>需要注意的是 <code>Iterations</code> 是迭代，不是并发</strong></p><p><img src="https://i.ibb.co/z6TGbFX/Postman-Collections-setting.png" alt="IMG"></p><p>Result<br>结果如下图，是不是可以很方便的看出测试结果。</p><p><img src="https://i.ibb.co/5nwGMTV/Postman-Collections.png" alt="IMG"></p><p><em>BTW,<code>collection</code> 支持在 <a href="https://learning.getpostman.com/docs/postman/collection_runs/newman_with_docker/" target="_blank" rel="noopener"><code>Docker(可点击跳转)</code></a> 和 <a href="https://learning.getpostman.com/docs/postman/collection_runs/integration_with_jenkins/" target="_blank" rel="noopener"><code>Jenkins(可点击跳转)</code></a> 中使用，每次看到这些东西就有种转测试的冲动。。。，本人这部分也没有研究，有需要的可以研究下。</em></p><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><ol><li><a href="https://learning.getpostman.com/" target="_blank" rel="noopener">Postman Learning Center</a></li><li><a href="https://learning.getpostman.com/docs/postman/scripts/pre_request_scripts" target="_blank" rel="noopener">pre_request_scripts</a></li><li><a href="https://learning.getpostman.com/docs/postman/scripts/test_scripts" target="_blank" rel="noopener">test_scripts</a></li><li><a href="https://learning.getpostman.com/docs/postman/environments_and_globals/intro_to_environments_and_globals" target="_blank" rel="noopener">intro_to_environments_and_globals</a></li><li><a href="https://learning.getpostman.com/docs/postman/collections/intro_to_collections" target="_blank" rel="noopener">collections</a></li></ol>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>LEFT JOIN ON AND/WHERE</title>
      <link href="/2018/11/26/LEFT-JOIN-ON-WHERE/"/>
      <url>/2018/11/26/LEFT-JOIN-ON-WHERE/</url>
      
        <content type="html"><![CDATA[<h1 id="LEFT-JOIN-ON-AND-WHERE"><a href="#LEFT-JOIN-ON-AND-WHERE" class="headerlink" title="LEFT JOIN ON AND/WHERE"></a>LEFT JOIN ON AND/WHERE</h1><h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><blockquote><p>这两个SQL查询的结果相同吗?</p></blockquote><figure class="highlight sql"><figcaption><span>SQL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">AND</span> a.TableAId =<span class="number">1</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">WHERE</span> a.TableAId = <span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="Test-SQL"><a href="#Test-SQL" class="headerlink" title="Test SQL"></a>Test SQL</h2><h3 id="Creat-Database"><a href="#Creat-Database" class="headerlink" title="Creat Database"></a>Creat Database</h3><figure class="highlight sql"><figcaption><span>TEST Database</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Create a new database called 'TEST' for XKA</span></span><br><span class="line"><span class="comment">-- Connect to the 'master' database to run this snippet</span></span><br><span class="line"><span class="keyword">USE</span> <span class="keyword">master</span></span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="comment">-- Create the new database if it does not exist already</span></span><br><span class="line"><span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">FROM</span> sys.databases</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">name</span> = N<span class="string">'TEST'</span> </span><br><span class="line">)</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">TEST</span></span><br><span class="line"><span class="keyword">GO</span></span><br></pre></td></tr></table></figure><h3 id="Creat-Table"><a href="#Creat-Table" class="headerlink" title="Creat Table"></a>Creat Table</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USE</span> <span class="keyword">TEST</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Create a new table called 'TableA' in schema 'TEST'</span></span><br><span class="line"><span class="comment">-- Drop the table if it already exists</span></span><br><span class="line"><span class="keyword">IF</span> OBJECT_ID(<span class="string">'TEST.TableA'</span>, <span class="string">'U'</span>) <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> TEST.TableA</span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="comment">-- Create the table in the specified schema</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TableA</span><br><span class="line">(</span><br><span class="line">    TableAId <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="comment">-- primary key column</span></span><br><span class="line">    Code [<span class="keyword">NVARCHAR</span>](<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="keyword">Name</span> [<span class="keyword">NVARCHAR</span>](<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">    <span class="comment">-- specify more columns here</span></span><br><span class="line">);</span><br><span class="line">GO</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Create a new table called 'TableB' in schema 'SchemaName'</span></span><br><span class="line"><span class="comment">-- Drop the table if it already exists</span></span><br><span class="line">IF OBJECT_ID('TEST.TableB', 'U') IS NOT NULL</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> TableB</span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="comment">-- Create the table in the specified schema</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TableB</span><br><span class="line">(</span><br><span class="line">    TableBId <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="comment">-- primary key column</span></span><br><span class="line">    AId <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    Code [<span class="keyword">NVARCHAR</span>](<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="keyword">Name</span> [<span class="keyword">NVARCHAR</span>](<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">    <span class="comment">-- specify more columns here</span></span><br><span class="line">);</span><br><span class="line">GO</span><br></pre></td></tr></table></figure><h3 id="Creat-Data"><a href="#Creat-Data" class="headerlink" title="Creat Data"></a>Creat Data</h3><figure class="highlight sql"><figcaption><span>Creat Data</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Insert rows into table 'TableA'</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TableA</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    ( <span class="comment">-- first row: values for the columns in the list above</span></span><br><span class="line">         <span class="number">1</span>, <span class="string">'A'</span>, <span class="string">'A'</span></span><br><span class="line">),</span><br><span class="line">    ( <span class="comment">-- second row: values for the columns in the list above</span></span><br><span class="line">         <span class="number">2</span>, <span class="string">'B'</span>, <span class="string">'B'</span></span><br><span class="line">),</span><br><span class="line">    (<span class="number">3</span>, <span class="string">'C'</span>, <span class="string">'C'</span>)</span><br><span class="line"><span class="comment">-- add more rows here</span></span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Insert rows into table 'TableB'</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TableB</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    ( <span class="comment">-- columns to insert data into</span></span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="string">'C'</span>, <span class="string">'C'</span></span><br><span class="line">),</span><br><span class="line">    ( <span class="comment">-- first row: values for the columns in the list above</span></span><br><span class="line">        <span class="number">2</span>, <span class="number">1</span>, <span class="string">'D'</span>, <span class="string">'D'</span></span><br><span class="line">),</span><br><span class="line">    ( <span class="comment">-- second row: values for the columns in the list above</span></span><br><span class="line">        <span class="number">3</span>, <span class="number">2</span>, <span class="string">'E'</span>, <span class="string">'E'</span></span><br><span class="line">),</span><br><span class="line">    ( <span class="comment">-- second row: values for the columns in the list above</span></span><br><span class="line">        <span class="number">4</span>, <span class="number">2</span>, <span class="string">'D'</span>, <span class="string">'D'</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">-- add more rows here</span></span><br><span class="line"><span class="keyword">GO</span></span><br></pre></td></tr></table></figure><h2 id="Query-Result"><a href="#Query-Result" class="headerlink" title="Query Result"></a>Query Result</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">C</td><td style="text-align:center">C</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">B</td><td style="text-align:center">3</td><td style="text-align:center">2</td><td style="text-align:center">E</td><td style="text-align:center">E</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">B</td><td style="text-align:center">4</td><td style="text-align:center">2</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">C</td><td style="text-align:center">C</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">AND</span> a.code =<span class="string">'H'</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">B</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">C</td><td style="text-align:center">C</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">AND</span> a.TableAId =<span class="number">1</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">C</td><td style="text-align:center">C</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">B</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">C</td><td style="text-align:center">C</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">AND</span> b.AId = <span class="number">1</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">C</td><td style="text-align:center">C</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">B</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">C</td><td style="text-align:center">C</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">WHERE</span> a.TableAId = <span class="number">1</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">C</td><td style="text-align:center">C</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">WHERE</span> b.AId =<span class="number">1</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">C</td><td style="text-align:center">C</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr></tbody></table><h3 id="ALL"><a href="#ALL" class="headerlink" title="ALL"></a>ALL</h3><p><img src="https://i.ibb.co/56p1ydb/left-join-on-where.png" alt="IMAGE"></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><blockquote><p>连接多张表查询时会生成临时表,使用<code>LEFT JOIN</code>时</p></blockquote><ul><li><code>ON</code> 是生成临时表的条件，不管ON的结果是否为真，都会返回左边表的所有数据</li><li><code>AND</code> 是在<code>ON</code>的基础上进行过滤，但是仍会返回左边表的所有数据</li><li><code>WHERE</code> 是在临时表生成后，进行过滤，相当于对单表进行过滤</li></ul><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><blockquote><p><a href="https://stackoverflow.com/questions/44696051/sql-different-between-left-join-on-and-left-join-on-where?r=SearchResults" target="_blank" rel="noopener">Stackoverflow</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> LEFT JOIN </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>WindowsProgramMonitorService</title>
      <link href="/2018/11/19/WindowsProgramMonitorService/"/>
      <url>/2018/11/19/WindowsProgramMonitorService/</url>
      
        <content type="html"><![CDATA[<h1 id="WindowsProgramMonitorService"><a href="#WindowsProgramMonitorService" class="headerlink" title="WindowsProgramMonitorService"></a>WindowsProgramMonitorService</h1><hr><h2 id="Topshelf"><a href="#Topshelf" class="headerlink" title="Topshelf"></a>Topshelf</h2><h3 id="Nuget"><a href="#Nuget" class="headerlink" title="Nuget"></a>Nuget</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install-Package Topshelf</span><br></pre></td></tr></table></figure><h3 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rc = HostFactory.Run(x =&gt; &#123;</span><br><span class="line"></span><br><span class="line">                x.Service&lt;ProgramService&gt;(s =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    s.ConstructUsing(name =&gt; <span class="keyword">new</span> ProgramService());</span><br><span class="line">                    s.WhenStarted(p =&gt; p.Start());</span><br><span class="line">                    s.WhenStopped(p =&gt; p.Stop());</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                x.RunAsLocalSystem();</span><br><span class="line"></span><br><span class="line">                x.SetDescription(<span class="string">"Windows Program Monitor Service Host"</span>);</span><br><span class="line">                x.SetDisplayName(<span class="string">"Windows Program Monitor Service"</span>);</span><br><span class="line">                x.SetServiceName(<span class="string">"Windows Program Monitor Service"</span>);</span><br><span class="line">            &#125;);</span><br></pre></td></tr></table></figure><h3 id="ProgramService"><a href="#ProgramService" class="headerlink" title="ProgramService"></a>ProgramService</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">readonly</span> Timer _timer;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ProgramService</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    _timer = <span class="keyword">new</span> Timer(<span class="number">1000</span>) &#123; AutoReset = <span class="literal">true</span> &#125;;</span><br><span class="line">    _timer.Elapsed +=</span><br><span class="line">        (sender, eventArgs) =&gt;</span><br><span class="line">        Console.WriteLine(<span class="string">$"It is <span class="subst">&#123;DateTime.Now&#125;</span> and all is well"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    _timer.Start();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Stop</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    _timer.Stop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Program"><a href="#Program" class="headerlink" title="Program"></a>Program</h2><h3 id="GETProcess"><a href="#GETProcess" class="headerlink" title="GETProcess"></a>GETProcess</h3><figure class="highlight cs"><figcaption><span>GetMainProcess()</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">GetMainProcess</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> processlist = Process.GetProcesses();</span><br><span class="line">    <span class="keyword">var</span> result = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (Process process <span class="keyword">in</span> processlist)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!String.IsNullOrEmpty(process.MainWindowTitle))</span><br><span class="line">        &#123;</span><br><span class="line">            result += <span class="string">$"Process: <span class="subst">&#123;process.ProcessName&#125;</span>, Window title: <span class="subst">&#123;process.MainWindowTitle&#125;</span>,Start Time : <span class="subst">&#123;process.StartTime&#125;</span> ,Running Time: <span class="subst">&#123;DateTime.Now - process.StartTime&#125;</span>\n"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="log4net"><a href="#log4net" class="headerlink" title="log4net"></a>log4net</h2><h3 id="Nuget-1"><a href="#Nuget-1" class="headerlink" title="Nuget"></a>Nuget</h3><figure class="highlight plain"><figcaption><span>Nuget</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install-Package log4net</span><br></pre></td></tr></table></figure><p>###</p><h1 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h1><blockquote><p><a href="https://topshelf.readthedocs.io/en/latest/configuration/quickstart.html" target="_blank" rel="noopener">Topself Quick Start</a></p></blockquote><blockquote><p><a href="http://logging.apache.org/log4net/release/manual/configuration.html" target="_blank" rel="noopener">log4net configuration</a></p></blockquote>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>WITH common_table_expression</title>
      <link href="/2018/11/10/WITH-common-table-expression/"/>
      <url>/2018/11/10/WITH-common-table-expression/</url>
      
        <content type="html"><![CDATA[<h1 id="WITH-common-table-expression"><a href="#WITH-common-table-expression" class="headerlink" title="WITH common_table_expression"></a>WITH common_table_expression</h1><blockquote><p>先上个官方说明 <br><br>Specifies a temporary named result set, known as a common table expression (CTE). This is derived from a simple query and defined within the execution scope of a single SELECT, INSERT, UPDATE, or DELETE statement. This clause can also be used in a CREATE VIEW statement as part of its defining SELECT statement. A common table expression can include references to itself. This is referred to as a recursive common table expression.</p></blockquote><p> 简单理解，就是把一个查询结果临时存到指定的表达式上，这个表达式就叫<code>公用表表达式</code> <code>CTE</code>(Common Table Expression)。 可以简单理解为一个不会实际创建的视图。</p><h2 id="WHY"><a href="#WHY" class="headerlink" title="WHY"></a>WHY</h2><p> 为什么要用这个呢？</p><p> 经常遇到多表需要关联查询，虽然所有的都可以通过<code>视图</code>, <code>临时表</code>，或者多写几个<code>SELECT</code>来实现，但是多数为一次性查询，没必要创建视图，而<code>SELECT</code>的可读性太低（特别是业务复杂的时候）。使用<code>WITH</code>就可以避免这些问题，也不需要多余的开支。</p><h2 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[ WITH &lt;common_table_expression&gt; [ ,...n ] ]  </span><br><span class="line"></span><br><span class="line">&lt;common_table_expression&gt;::=  </span><br><span class="line">    expression_name [ ( column_name [ ,...n ] ) ]  </span><br><span class="line">    AS  </span><br><span class="line">    ( CTE_query_definition )</span><br></pre></td></tr></table></figure><ul><li><code>expression_name</code> [^xxxka] 公用表表达式的有效标识符（必须不同与其他CTE名称,可以与基视图或基表名称相同）</li><li><code>column_name</code> 公用表达式列名</li><li><code>CTE_query_definition</code> 查询语句（与创建<a href="https://docs.microsoft.com/zh-cn/sql/t-sql/statements/create-view-transact-sql?view=sql-server-2017" target="_blank" rel="noopener">视图</a>要求相同）</li></ul><h2 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h2><h3 id="用到的表"><a href="#用到的表" class="headerlink" title="用到的表"></a>用到的表</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">卡值流水表 CardHistoryTable(只有总的卡值变化)</span><br><span class="line">卡值流水详情表 CardHistoryDetailTable(包括支付宝，微信卡值变动)</span><br></pre></td></tr></table></figure><h3 id="简单的例子"><a href="#简单的例子" class="headerlink" title="简单的例子"></a>简单的例子</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">WITH CardPerson AS</span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span> PersonId,<span class="keyword">MAX</span>(<span class="keyword">id</span>) <span class="keyword">AS</span> maxId <span class="keyword">FROM</span> CardHistoryTable <span class="keyword">GROUP</span> <span class="keyword">BY</span> PersonId)</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> CardPerson</span><br></pre></td></tr></table></figure><h3 id="使用多个CTE"><a href="#使用多个CTE" class="headerlink" title="使用多个CTE"></a>使用多个CTE</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">WITH MiddlePersonDetail AS</span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span> m.mainId, m.fee, m.is_wechat, m.wechat_balance, m.id, m.alipay_balance,f.PersonId </span><br><span class="line"><span class="keyword">FROM</span> CardHistoryDetailTable m <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> CardHistoryTable f <span class="keyword">ON</span> f.id = m.mainId</span><br><span class="line">),</span><br><span class="line">MiddlePerson <span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span> PersonId,<span class="keyword">MAX</span>(<span class="keyword">id</span>) <span class="keyword">AS</span> maxid <span class="keyword">FROM</span> MiddlePersonDetail <span class="keyword">GROUP</span> <span class="keyword">BY</span> PersonId</span><br><span class="line">)</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> MiddlePerson</span><br></pre></td></tr></table></figure><h3 id="实际查询场景"><a href="#实际查询场景" class="headerlink" title="实际查询场景"></a>实际查询场景</h3><p>CardHistoryTable包含多种类型的卡值变化（收入，消费支出，转账，还款等），detail计算的程序有一部分并不处理（比如还款，由操作员手动录入），现在想查每个人最后的余额在两个表是否一致，以及剩余的支付宝，微信余额等,再决定数据处理方式</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">WITH CardPerson AS</span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span> PersonId,<span class="keyword">MAX</span>(<span class="keyword">id</span>) <span class="keyword">AS</span> maxId <span class="keyword">FROM</span> CardHistoryTable <span class="keyword">GROUP</span> <span class="keyword">BY</span> PersonId),</span><br><span class="line">MiddlePersonDetail <span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span> m.mainId, m.fee, m.is_wechat, m.wechat_balance, m.id, m.alipay_balance,f.PersonId </span><br><span class="line"><span class="keyword">FROM</span> CardHistoryDetailTable m <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> CardHistoryTable f <span class="keyword">ON</span> f.id = m.mainId</span><br><span class="line">),</span><br><span class="line">MiddlePerson <span class="keyword">AS</span></span><br><span class="line">(</span><br><span class="line"><span class="keyword">SELECT</span> PersonId,<span class="keyword">MAX</span>(<span class="keyword">id</span>) <span class="keyword">AS</span> maxid <span class="keyword">FROM</span> MiddlePersonDetail <span class="keyword">GROUP</span> <span class="keyword">BY</span> PersonId</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> mg.PersonId,mg.maxid,m.wechat_balance,m.is_wechat,m.alipay_balance,</span><br><span class="line">m.mainId, f.id,f.this_balance </span><br><span class="line"><span class="keyword">FROM</span> MiddlePerson mg </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> CardHistoryDetailTable m <span class="keyword">ON</span> m.id = mg.maxid </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> MiddlePerson fg <span class="keyword">ON</span> fg.PersonId = mg.PersonId </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> CardPerson f <span class="keyword">ON</span> fg.maxId = f.id</span><br><span class="line"><span class="comment">--WHERE ...</span></span><br></pre></td></tr></table></figure><h2 id="一些需要注意的"><a href="#一些需要注意的" class="headerlink" title="一些需要注意的"></a>一些需要注意的</h2><blockquote><ul><li>如果定义了多个 CTE_query_definition，则这些查询定义必须用下列一个集合运算符联接起来：UNION ALL、UNION、EXCEPT 或 INTERSECT。</li><li>CTE 之后必须跟随引用部分或全部 CTE 列的单条 SELECT、INSERT、UPDATE 或 DELETE 语句。 也可以在 CREATE VIEW 语句中将 CTE 指定为视图中 SELECT 定义语句的一部分。</li></ul></blockquote><blockquote><p><a href="https://docs.microsoft.com/zh-cn/sql/t-sql/queries/with-common-table-expression-transact-sql?view=sql-server-2017#guidelines-for-creating-and-using-common-table-expressions" target="_blank" rel="noopener">MORE</a></p></blockquote><p> <strong>本文只讨论非递归公用表达式</strong>，对于递归的参见 <a href="https://docs.microsoft.com/zh-cn/sql/t-sql/queries/with-common-table-expression-transact-sql?view=sql-server-2017#guidelines-for-defining-and-using-recursive-common-table-expressions" target="_blank" rel="noopener">docs.microsoft.com</a></p><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><blockquote><p><a href="https://docs.microsoft.com/zh-cn/sql/t-sql/queries/with-common-table-expression-transact-sql" target="_blank" rel="noopener">MICROSOFT DOCS</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> WITH common_table_expression </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>XCOPY</title>
      <link href="/2018/11/07/XCOPY/"/>
      <url>/2018/11/07/XCOPY/</url>
      
        <content type="html"><![CDATA[<h1 id="XOPY"><a href="#XOPY" class="headerlink" title="XOPY"></a>XOPY</h1><hr><p><strong>XCOPY</strong> : Copies files and directories, including subdirectories</p><h2 id="cmd"><a href="#cmd" class="headerlink" title="cmd"></a>cmd</h2><blockquote><ul><li>xcopy /?</li></ul></blockquote><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">XOPY/复制文件和目录树。</span><br><span class="line"></span><br><span class="line">XCOPY source [destination] [/A | /M] [/D[:date]] [/P] [/S [/E]] [/V] [/W]</span><br><span class="line">                           [/C] [/I] [/Q] [/F] [/L] [/G] [/H] [/R] [/T] [/U]</span><br><span class="line">                           [/K] [/N] [/O] [/X] [/Y] [/-Y] [/Z] [/B] [/J]</span><br><span class="line">                           [/EXCLUDE:file1[+file2][+file3]...]</span><br><span class="line"></span><br><span class="line">  source       Required. Specifies the location and names of the files you want to copy. This parameter must include either a drive or a path./指定要复制的文件。</span><br><span class="line">  destination  Specifies the destination of the files you want to copy. This parameter can include a drive letter and colon, a directory name, a file name, or a combination of these./指定新文件的位置和/或名称。</span><br><span class="line">  /A           Copies only Source files that have their archive file attributes set. /a does not modify the archive file attribute of the source file./仅复制有存档属性集的文件，但不更改属性。</span><br><span class="line">  /M           Copies Source files that have their archive file attributes set. Unlike /a, /m turns off archive file attributes <span class="keyword">in</span> the files that are specified <span class="keyword">in</span> the source./仅复制有存档属性集的文件，并关闭存档属性。</span><br><span class="line">  /D:m-d-y     Copies source files changed on or after the specified date only. <span class="keyword">If</span> you <span class="keyword">do</span> not include a MM-DD-YYYY value, xcopy copies all Source files that are newer than existing Destination files. This command-line option allows you to update files that have changed./复制在指定日期或指定日期以后更改的文件。如果没有提供日期，只复制那些源时间比目标时间新的文件。</span><br><span class="line">  /EXCLUDE:file1[+file2][+file3]... Specifies a list of files. At least one file must be specified. Each file will contain search strings with each string on a separate line <span class="keyword">in</span> the file.When any of the strings match any part of the absolute path of the file to be copied, that file will be excuded from being copied. <span class="keyword">For</span> example, specifying the string obj will exclude all files underneath the directory obj or all files with the .obj extension./指定含有字符串的文件列表。每个字符串在文件中应位于单独的一行。如果任何字符串与复制文件的绝对路径的任何部分相符，则排除复制该文件。例如，指定如 \obj\ 或 .obj 的字符串会分别排除目录 obj 下面的所有文件或带有.obj 扩展名的所有文件。</span><br><span class="line">  /P           Prompts you to confirm whether you want to create each destination file./创建每个目标文件之前提示你。</span><br><span class="line">  /S           Copies directories and subdirectories, unless they are empty. <span class="keyword">If</span> you omit /s, xcopy works within a single directory./复制目录和子目录，不包括空目录。</span><br><span class="line">  /E           Copies all subdirectories, even <span class="keyword">if</span> they are empty. Use /e with the /s and /t command-line options./复制目录和子目录，包括空目录。与 /S /E 相同。可以用来修改 /T。</span><br><span class="line">  /V           Verifies each file as it is written to the destination file to make sure that the destination files are identical to the source files./验证每个新文件的大小。</span><br><span class="line">  /W           Displays the following message and waits <span class="keyword">for</span> your response before starting to copy files:Press any key to <span class="keyword">begin</span> copying file(s)/提示你在复制前按键。</span><br><span class="line">  /C           Ignores errors./即使有错误，也继续复制。</span><br><span class="line">  /I           <span class="keyword">If</span> Source is a directory or contains wildcards and Destination does not exist, xcopy assumes Destination specifies a directory name and creates a new directory. Then, xcopy copies all specified files into the new directory. By default, xcopy prompts you to specify whether Destination is a file or a directory./如果目标不存在，且要复制多个文件，则假定目标必须是目录。</span><br><span class="line">  /Q           Suppresses the display of xcopy messages./复制时不显示文件名。</span><br><span class="line">  /F           Displays source and destination file names <span class="keyword">while</span> copying./复制时显示完整的源文件名和目标文件名。</span><br><span class="line">  /L           Displays a list of files that are to be copied./显示要复制的文件。</span><br><span class="line">  /G           Creates decrypted Destination files when the destination does not support encryption./允许将加密文件复制到不支持加密的目标。</span><br><span class="line">  /H           Copies files with hidden and system file attributes. By default, xcopy does not copy hidden or system files/也复制隐藏文件和系统文件。</span><br><span class="line">  /R           Copies read-only files./覆盖只读文件。</span><br><span class="line">  /T           Copies the subdirectory structure (that is, the tree) only, not files. To copy empty directories, you must include the /e command-line option./创建目录结构，但不复制文件。不包括空目录或子目录。/T /E 包括空目录和子目录。</span><br><span class="line">  /U           Copies files from Source that exist on Destination only./只复制已经存在于目标中的文件。</span><br><span class="line">  /K           Copies files and retains the read-only attribute on Destination files <span class="keyword">if</span> present on the Source files. By default, xcopy removes the read-only attribute./复制属性。一般的 Xcopy 会重置只读属性。</span><br><span class="line">  /N           Creates copies by using the NTFS short file or directory names. /n is required when you copy files or directories from an NTFS volume to a FAT volume or when the FAT file system naming convention (that is, <span class="number">8.3</span> characters) is required on the Destination file system. The Destination file system can be FAT or NTFS./用生成的短名称复制。</span><br><span class="line">  /O           Copies file ownership and discretionary access control list (DACL) information./复制文件所有权和 ACL 信息。</span><br><span class="line">  /X           Copies file audit settings and system access control list (SACL) information (implies /o)./复制文件审核设置(隐含 /O)。</span><br><span class="line">  /Y           Suppresses prompting to confirm that you want to overwrite an existing destination file./取消提示以确认要覆盖现有目标文件。</span><br><span class="line">  /-Y          Prompts to confirm that you want to overwrite an existing destination file./要提示以确认要覆盖</span><br><span class="line">现有目标文件。</span><br><span class="line">  /Z           Copies over a network <span class="keyword">in</span> restartable mode./在可重新启动模式下复制网络文件。</span><br><span class="line">  /B           Copies the symbolic link instead of the files. This parameter was introduced <span class="keyword">in</span> Windows Vista®./复制符号链接本身与链接目标。</span><br><span class="line">  /J           Copies files without buffering. Recommended <span class="keyword">for</span> very large files. This parameter was added <span class="keyword">in</span> Windows Server <span class="number">2008</span> R2./复制时不使用缓冲的 I/O。推荐复制大文件时使用。</span><br><span class="line">  /?Displays help at the command prompt./在命令提示符中显示帮助</span><br></pre></td></tr></table></figure><h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><blockquote><ul><li>copy directories</li></ul></blockquote><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XCOPY D:\workspace\Demo D:\publish\Demo /E /Y /C /D</span><br></pre></td></tr></table></figure><blockquote><ul><li>copy file</li></ul></blockquote><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XCOPY D:\config\Demo\demo.config D:\publish\Demo\demo.config /Y</span><br></pre></td></tr></table></figure><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><blockquote><ul><li><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/xcopy" target="_blank" rel="noopener">Xopy</a></li></ul></blockquote><blockquote><ul><li><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/xcopy#BKMK_addref" target="_blank" rel="noopener">Additional</a></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> Windows Commands </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows Commands </tag>
            
            <tag> XCOPY </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Failed to load Msxmlsql.dll</title>
      <link href="/2018/07/16/Failed-to-load-Msxmlsql-dll/"/>
      <url>/2018/07/16/Failed-to-load-Msxmlsql-dll/</url>
      
        <content type="html"><![CDATA[<h1 id="Failed-to-load-Msxmlsql-dll"><a href="#Failed-to-load-Msxmlsql-dll" class="headerlink" title="Failed to load Msxmlsql.dll"></a>Failed to load Msxmlsql.dll</h1><ul><li>Solution：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\Microsoft SQL Server\100\Shared\msxmlsql.dll </span><br><span class="line">to</span><br><span class="line">C:\Program Files\Microsoft SQL Server\MSSQL10_50.[veeam-dbinstance]\MSSQL\Binn </span><br><span class="line"></span><br><span class="line">then copy &quot;msxmlsql.rll&quot; from </span><br><span class="line">C:\Program Files\Microsoft SQL Server\100\Shared\Resources\1033\msxmlsql.rll </span><br><span class="line">to</span><br><span class="line">C:\Program Files\Microsoft SQL Server\MSSQL10_50.[veeam-dbinstance]\MSSQL\Binn\Resources\1033</span><br><span class="line"></span><br><span class="line">Restart SQL Server Service</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Error </category>
          
          <category> SQL Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL Server </tag>
            
            <tag> SQL Server Error </tag>
            
            <tag> SQL Server 2008R2 </tag>
            
            <tag> Msxmlsql.dll </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SQL PadLeft</title>
      <link href="/2018/05/01/SQL%20PadLeft/"/>
      <url>/2018/05/01/SQL%20PadLeft/</url>
      
        <content type="html"><![CDATA[<h1 id="SQL-PadLeft"><a href="#SQL-PadLeft" class="headerlink" title="SQL PadLeft"></a>SQL PadLeft</h1><ul><li>SQL</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PRINT RIGHT(CAST(REPLICATE('0', LEN(no_start)) + CAST(no_start + (inventory - 1) AS VARCHAR(50)) AS VARCHAR(50)), LEN(no_start))</span><br><span class="line"></span><br><span class="line">PRINT RIGHT(CAST(REPLICATE('0', LEN('000001')) + CAST('000001' + (50 - 1) AS VARCHAR(50)) AS VARCHAR(50)), LEN('000001'))</span><br></pre></td></tr></table></figure><a id="more"></a><ul><li>Result<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">000050</span><br></pre></td></tr></table></figure></li></ul><hr><h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><p>Test Sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">PRINT RIGHT(CAST(REPLICATE('0', LEN('000001')) + CAST('000001' + (50 - 1) AS VARCHAR(50)) AS VARCHAR(50)), LEN('000001'))</span><br><span class="line"></span><br><span class="line">PRINT REPLICATE('0',5)</span><br><span class="line"></span><br><span class="line">PRINT REPLICATE('0',5) + 123</span><br><span class="line"></span><br><span class="line">PRINT REPLICATE('0',5) + '123'</span><br><span class="line"></span><br><span class="line">PRINT REPLICATE('0',5) + STR(123)</span><br><span class="line"></span><br><span class="line">PRINT REPLICATE('0',5) + CAST(123 AS varchar(20))</span><br><span class="line"></span><br><span class="line">PRINT STR(123)</span><br><span class="line"></span><br><span class="line">PRINT STR(123,5,2)</span><br><span class="line"></span><br><span class="line">PRINT STR(12345678900)</span><br></pre></td></tr></table></figure><p>Test Result</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">000050</span><br><span class="line">00000</span><br><span class="line">123</span><br><span class="line">00000123</span><br><span class="line">00000       123</span><br><span class="line">00000123</span><br><span class="line">        123</span><br><span class="line">123.0</span><br></pre></td></tr></table></figure><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><blockquote><p>C# <a href="https://msdn.microsoft.com/zh-cn/library/system.string.padleft.aspx" target="_blank" rel="noopener">PadLeft</a></p></blockquote><blockquote><p>SQL <a href="https://docs.microsoft.com/zh-cn/sql/t-sql/functions/replicate-transact-sql" target="_blank" rel="noopener">REPLICATE</a></p></blockquote><blockquote><p>SQL <a href="https://docs.microsoft.com/zh-cn/sql/t-sql/functions/str-transact-sql" target="_blank" rel="noopener">STR</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> REPLICATE </tag>
            
            <tag> C# </tag>
            
            <tag> PadLeft </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>README</title>
      <link href="/2018/05/01/README/"/>
      <url>/2018/05/01/README/</url>
      
        <content type="html"><![CDATA[<ul><li>I Will Show You</li></ul>]]></content>
      
      
      
    </entry>
    
  
  
</search>
