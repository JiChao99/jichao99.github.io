<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>LEFT JOIN ON AND/WHERE</title>
      <link href="/2018/11/26/LEFT-JOIN-ON-WHERE/"/>
      <url>/2018/11/26/LEFT-JOIN-ON-WHERE/</url>
      
        <content type="html"><![CDATA[<h1 id="LEFT-JOIN-ON-AND-WHERE"><a href="#LEFT-JOIN-ON-AND-WHERE" class="headerlink" title="LEFT JOIN ON AND/WHERE"></a>LEFT JOIN ON AND/WHERE</h1><h2 id="Question"><a href="#Question" class="headerlink" title="Question"></a>Question</h2><blockquote><p>这两个SQL查询的结果相同吗?</p></blockquote><figure class="highlight sql"><figcaption><span>SQL</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">AND</span> a.TableAId =<span class="number">1</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">WHERE</span> a.TableAId = <span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="Test-SQL"><a href="#Test-SQL" class="headerlink" title="Test SQL"></a>Test SQL</h2><h3 id="Creat-Database"><a href="#Creat-Database" class="headerlink" title="Creat Database"></a>Creat Database</h3><figure class="highlight sql"><figcaption><span>TEST Database</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Create a new database called 'TEST' for XKA</span></span><br><span class="line"><span class="comment">-- Connect to the 'master' database to run this snippet</span></span><br><span class="line"><span class="keyword">USE</span> <span class="keyword">master</span></span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="comment">-- Create the new database if it does not exist already</span></span><br><span class="line"><span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">FROM</span> sys.databases</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">name</span> = N<span class="string">'TEST'</span> </span><br><span class="line">)</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="keyword">TEST</span></span><br><span class="line"><span class="keyword">GO</span></span><br></pre></td></tr></table></figure><h3 id="Creat-Table"><a href="#Creat-Table" class="headerlink" title="Creat Table"></a>Creat Table</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USE</span> <span class="keyword">TEST</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Create a new table called 'TableA' in schema 'TEST'</span></span><br><span class="line"><span class="comment">-- Drop the table if it already exists</span></span><br><span class="line"><span class="keyword">IF</span> OBJECT_ID(<span class="string">'TEST.TableA'</span>, <span class="string">'U'</span>) <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> TEST.TableA</span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="comment">-- Create the table in the specified schema</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TableA</span><br><span class="line">(</span><br><span class="line">    TableAId <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="comment">-- primary key column</span></span><br><span class="line">    Code [<span class="keyword">NVARCHAR</span>](<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="keyword">Name</span> [<span class="keyword">NVARCHAR</span>](<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">    <span class="comment">-- specify more columns here</span></span><br><span class="line">);</span><br><span class="line">GO</span><br><span class="line"></span><br><span class="line"><span class="comment">-- Create a new table called 'TableB' in schema 'SchemaName'</span></span><br><span class="line"><span class="comment">-- Drop the table if it already exists</span></span><br><span class="line">IF OBJECT_ID('TEST.TableB', 'U') IS NOT NULL</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> TableB</span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"><span class="comment">-- Create the table in the specified schema</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TableB</span><br><span class="line">(</span><br><span class="line">    TableBId <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="comment">-- primary key column</span></span><br><span class="line">    AId <span class="built_in">INT</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    Code [<span class="keyword">NVARCHAR</span>](<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="keyword">Name</span> [<span class="keyword">NVARCHAR</span>](<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">    <span class="comment">-- specify more columns here</span></span><br><span class="line">);</span><br><span class="line">GO</span><br></pre></td></tr></table></figure><h3 id="Creat-Data"><a href="#Creat-Data" class="headerlink" title="Creat Data"></a>Creat Data</h3><figure class="highlight sql"><figcaption><span>Creat Data</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Insert rows into table 'TableA'</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TableA</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    ( <span class="comment">-- first row: values for the columns in the list above</span></span><br><span class="line">         <span class="number">1</span>, <span class="string">'A'</span>, <span class="string">'A'</span></span><br><span class="line">),</span><br><span class="line">    ( <span class="comment">-- second row: values for the columns in the list above</span></span><br><span class="line">         <span class="number">2</span>, <span class="string">'B'</span>, <span class="string">'B'</span></span><br><span class="line">),</span><br><span class="line">    (<span class="number">3</span>, <span class="string">'C'</span>, <span class="string">'C'</span>)</span><br><span class="line"><span class="comment">-- add more rows here</span></span><br><span class="line"><span class="keyword">GO</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- Insert rows into table 'TableB'</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TableB</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">    ( <span class="comment">-- columns to insert data into</span></span><br><span class="line">        <span class="number">1</span>, <span class="number">1</span>, <span class="string">'C'</span>, <span class="string">'C'</span></span><br><span class="line">),</span><br><span class="line">    ( <span class="comment">-- first row: values for the columns in the list above</span></span><br><span class="line">        <span class="number">2</span>, <span class="number">1</span>, <span class="string">'D'</span>, <span class="string">'D'</span></span><br><span class="line">),</span><br><span class="line">    ( <span class="comment">-- second row: values for the columns in the list above</span></span><br><span class="line">        <span class="number">3</span>, <span class="number">2</span>, <span class="string">'E'</span>, <span class="string">'E'</span></span><br><span class="line">),</span><br><span class="line">    ( <span class="comment">-- second row: values for the columns in the list above</span></span><br><span class="line">        <span class="number">4</span>, <span class="number">2</span>, <span class="string">'D'</span>, <span class="string">'D'</span></span><br><span class="line">)</span><br><span class="line"><span class="comment">-- add more rows here</span></span><br><span class="line"><span class="keyword">GO</span></span><br></pre></td></tr></table></figure><h2 id="Query-Result"><a href="#Query-Result" class="headerlink" title="Query Result"></a>Query Result</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">C</td><td style="text-align:center">C</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">B</td><td style="text-align:center">3</td><td style="text-align:center">2</td><td style="text-align:center">E</td><td style="text-align:center">E</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">B</td><td style="text-align:center">4</td><td style="text-align:center">2</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">C</td><td style="text-align:center">C</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">AND</span> a.code =<span class="string">'H'</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">B</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">C</td><td style="text-align:center">C</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">AND</span> a.TableAId =<span class="number">1</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">C</td><td style="text-align:center">C</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">B</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">C</td><td style="text-align:center">C</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">AND</span> b.AId = <span class="number">1</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">C</td><td style="text-align:center">C</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr><tr><td style="text-align:center">2</td><td style="text-align:center">B</td><td style="text-align:center">B</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr><tr><td style="text-align:center">3</td><td style="text-align:center">C</td><td style="text-align:center">C</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td><td style="text-align:center">NULL</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">WHERE</span> a.TableAId = <span class="number">1</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">C</td><td style="text-align:center">C</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr></tbody></table><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TableA a <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> TableB b <span class="keyword">ON</span>  b.AId =a.TableAId <span class="keyword">WHERE</span> b.AId =<span class="number">1</span></span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">TableAId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th><th style="text-align:center">TableBId</th><th style="text-align:center">AId</th><th style="text-align:center">Code</th><th style="text-align:center">Name</th></tr></thead><tbody><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">1</td><td style="text-align:center">1</td><td style="text-align:center">C</td><td style="text-align:center">C</td></tr><tr><td style="text-align:center">1</td><td style="text-align:center">A</td><td style="text-align:center">A</td><td style="text-align:center">2</td><td style="text-align:center">1</td><td style="text-align:center">D</td><td style="text-align:center">D</td></tr></tbody></table><h3 id="ALL"><a href="#ALL" class="headerlink" title="ALL"></a>ALL</h3><p><img src="https://i.ibb.co/56p1ydb/left-join-on-where.png" alt="IMAGE"></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><blockquote><p>连接多张表查询时会生成临时表,使用<code>LEFT JOIN</code>时</p></blockquote><ul><li><code>ON</code> 是生成临时表的条件，不管ON的结果是否为真，都会返回左边表的所有数据</li><li><code>AND</code> 是在<code>ON</code>的基础上进行过滤，但是仍会返回左边表的所有数据</li><li><code>WHERE</code> 是在临时表生成后，进行过滤，相当于对单表进行过滤</li></ul><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><blockquote><p><a href="https://stackoverflow.com/questions/44696051/sql-different-between-left-join-on-and-left-join-on-where?r=SearchResults" target="_blank" rel="noopener">Stackoverflow</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> LEFT JOIN </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>WindowsProgramMonitorService</title>
      <link href="/2018/11/19/WindowsProgramMonitorService/"/>
      <url>/2018/11/19/WindowsProgramMonitorService/</url>
      
        <content type="html"><![CDATA[<h1 id="WindowsProgramMonitorService"><a href="#WindowsProgramMonitorService" class="headerlink" title="WindowsProgramMonitorService"></a>WindowsProgramMonitorService</h1><hr><h2 id="Topshelf"><a href="#Topshelf" class="headerlink" title="Topshelf"></a>Topshelf</h2><h3 id="Nuget"><a href="#Nuget" class="headerlink" title="Nuget"></a>Nuget</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install-Package Topshelf</span><br></pre></td></tr></table></figure><h3 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> rc = HostFactory.Run(x =&gt; &#123;</span><br><span class="line"></span><br><span class="line">                x.Service&lt;ProgramService&gt;(s =&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    s.ConstructUsing(name =&gt; <span class="keyword">new</span> ProgramService());</span><br><span class="line">                    s.WhenStarted(p =&gt; p.Start());</span><br><span class="line">                    s.WhenStopped(p =&gt; p.Stop());</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                x.RunAsLocalSystem();</span><br><span class="line"></span><br><span class="line">                x.SetDescription(<span class="string">"Windows Program Monitor Service Host"</span>);</span><br><span class="line">                x.SetDisplayName(<span class="string">"Windows Program Monitor Service"</span>);</span><br><span class="line">                x.SetServiceName(<span class="string">"Windows Program Monitor Service"</span>);</span><br><span class="line">            &#125;);</span><br></pre></td></tr></table></figure><h3 id="ProgramService"><a href="#ProgramService" class="headerlink" title="ProgramService"></a>ProgramService</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">readonly</span> Timer _timer;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ProgramService</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    _timer = <span class="keyword">new</span> Timer(<span class="number">1000</span>) &#123; AutoReset = <span class="literal">true</span> &#125;;</span><br><span class="line">    _timer.Elapsed +=</span><br><span class="line">        (sender, eventArgs) =&gt;</span><br><span class="line">        Console.WriteLine(<span class="string">$"It is <span class="subst">&#123;DateTime.Now&#125;</span> and all is well"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Start</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    _timer.Start();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Stop</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    _timer.Stop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Program"><a href="#Program" class="headerlink" title="Program"></a>Program</h2><h3 id="GETProcess"><a href="#GETProcess" class="headerlink" title="GETProcess"></a>GETProcess</h3><figure class="highlight cs"><figcaption><span>GetMainProcess()</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">string</span> <span class="title">GetMainProcess</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> processlist = Process.GetProcesses();</span><br><span class="line">    <span class="keyword">var</span> result = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (Process process <span class="keyword">in</span> processlist)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!String.IsNullOrEmpty(process.MainWindowTitle))</span><br><span class="line">        &#123;</span><br><span class="line">            result += <span class="string">$"Process: <span class="subst">&#123;process.ProcessName&#125;</span>, Window title: <span class="subst">&#123;process.MainWindowTitle&#125;</span>,Start Time : <span class="subst">&#123;process.StartTime&#125;</span> ,Running Time: <span class="subst">&#123;DateTime.Now - process.StartTime&#125;</span>\n"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="log4net"><a href="#log4net" class="headerlink" title="log4net"></a>log4net</h2><h3 id="Nuget-1"><a href="#Nuget-1" class="headerlink" title="Nuget"></a>Nuget</h3><figure class="highlight plain"><figcaption><span>Nuget</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Install-Package log4net</span><br></pre></td></tr></table></figure><p>###</p><h1 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h1><blockquote><p><a href="https://topshelf.readthedocs.io/en/latest/configuration/quickstart.html" target="_blank" rel="noopener">Topself Quick Start</a></p></blockquote><blockquote><p><a href="http://logging.apache.org/log4net/release/manual/configuration.html" target="_blank" rel="noopener">log4net configuration</a></p></blockquote>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>WITH common_table_expression</title>
      <link href="/2018/11/10/WITH-common-table-expression/"/>
      <url>/2018/11/10/WITH-common-table-expression/</url>
      
        <content type="html"><![CDATA[<h1 id="WITH-common-table-expression"><a href="#WITH-common-table-expression" class="headerlink" title="WITH common_table_expression"></a>WITH common_table_expression</h1><hr>]]></content>
      
      
      <categories>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>XCOPY</title>
      <link href="/2018/11/07/XCOPY/"/>
      <url>/2018/11/07/XCOPY/</url>
      
        <content type="html"><![CDATA[<h1 id="XOPY"><a href="#XOPY" class="headerlink" title="XOPY"></a>XOPY</h1><hr><p><strong>XCOPY</strong> : Copies files and directories, including subdirectories</p><h2 id="cmd"><a href="#cmd" class="headerlink" title="cmd"></a>cmd</h2><blockquote><ul><li>xcopy /?</li></ul></blockquote><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">XOPY/复制文件和目录树。</span><br><span class="line"></span><br><span class="line">XCOPY source [destination] [/A | /M] [/D[:date]] [/P] [/S [/E]] [/V] [/W]</span><br><span class="line">                           [/C] [/I] [/Q] [/F] [/L] [/G] [/H] [/R] [/T] [/U]</span><br><span class="line">                           [/K] [/N] [/O] [/X] [/Y] [/-Y] [/Z] [/B] [/J]</span><br><span class="line">                           [/EXCLUDE:file1[+file2][+file3]...]</span><br><span class="line"></span><br><span class="line">  source       Required. Specifies the location and names of the files you want to copy. This parameter must include either a drive or a path./指定要复制的文件。</span><br><span class="line">  destination  Specifies the destination of the files you want to copy. This parameter can include a drive letter and colon, a directory name, a file name, or a combination of these./指定新文件的位置和/或名称。</span><br><span class="line">  /A           Copies only Source files that have their archive file attributes set. /a does not modify the archive file attribute of the source file./仅复制有存档属性集的文件，但不更改属性。</span><br><span class="line">  /M           Copies Source files that have their archive file attributes set. Unlike /a, /m turns off archive file attributes <span class="keyword">in</span> the files that are specified <span class="keyword">in</span> the source./仅复制有存档属性集的文件，并关闭存档属性。</span><br><span class="line">  /D:m-d-y     Copies source files changed on or after the specified date only. <span class="keyword">If</span> you <span class="keyword">do</span> not include a MM-DD-YYYY value, xcopy copies all Source files that are newer than existing Destination files. This command-line option allows you to update files that have changed./复制在指定日期或指定日期以后更改的文件。如果没有提供日期，只复制那些源时间比目标时间新的文件。</span><br><span class="line">  /EXCLUDE:file1[+file2][+file3]... Specifies a list of files. At least one file must be specified. Each file will contain search strings with each string on a separate line <span class="keyword">in</span> the file.When any of the strings match any part of the absolute path of the file to be copied, that file will be excuded from being copied. <span class="keyword">For</span> example, specifying the string obj will exclude all files underneath the directory obj or all files with the .obj extension./指定含有字符串的文件列表。每个字符串在文件中应位于单独的一行。如果任何字符串与复制文件的绝对路径的任何部分相符，则排除复制该文件。例如，指定如 \obj\ 或 .obj 的字符串会分别排除目录 obj 下面的所有文件或带有.obj 扩展名的所有文件。</span><br><span class="line">  /P           Prompts you to confirm whether you want to create each destination file./创建每个目标文件之前提示你。</span><br><span class="line">  /S           Copies directories and subdirectories, unless they are empty. <span class="keyword">If</span> you omit /s, xcopy works within a single directory./复制目录和子目录，不包括空目录。</span><br><span class="line">  /E           Copies all subdirectories, even <span class="keyword">if</span> they are empty. Use /e with the /s and /t command-line options./复制目录和子目录，包括空目录。与 /S /E 相同。可以用来修改 /T。</span><br><span class="line">  /V           Verifies each file as it is written to the destination file to make sure that the destination files are identical to the source files./验证每个新文件的大小。</span><br><span class="line">  /W           Displays the following message and waits <span class="keyword">for</span> your response before starting to copy files:Press any key to <span class="keyword">begin</span> copying file(s)/提示你在复制前按键。</span><br><span class="line">  /C           Ignores errors./即使有错误，也继续复制。</span><br><span class="line">  /I           <span class="keyword">If</span> Source is a directory or contains wildcards and Destination does not exist, xcopy assumes Destination specifies a directory name and creates a new directory. Then, xcopy copies all specified files into the new directory. By default, xcopy prompts you to specify whether Destination is a file or a directory./如果目标不存在，且要复制多个文件，则假定目标必须是目录。</span><br><span class="line">  /Q           Suppresses the display of xcopy messages./复制时不显示文件名。</span><br><span class="line">  /F           Displays source and destination file names <span class="keyword">while</span> copying./复制时显示完整的源文件名和目标文件名。</span><br><span class="line">  /L           Displays a list of files that are to be copied./显示要复制的文件。</span><br><span class="line">  /G           Creates decrypted Destination files when the destination does not support encryption./允许将加密文件复制到不支持加密的目标。</span><br><span class="line">  /H           Copies files with hidden and system file attributes. By default, xcopy does not copy hidden or system files/也复制隐藏文件和系统文件。</span><br><span class="line">  /R           Copies read-only files./覆盖只读文件。</span><br><span class="line">  /T           Copies the subdirectory structure (that is, the tree) only, not files. To copy empty directories, you must include the /e command-line option./创建目录结构，但不复制文件。不包括空目录或子目录。/T /E 包括空目录和子目录。</span><br><span class="line">  /U           Copies files from Source that exist on Destination only./只复制已经存在于目标中的文件。</span><br><span class="line">  /K           Copies files and retains the read-only attribute on Destination files <span class="keyword">if</span> present on the Source files. By default, xcopy removes the read-only attribute./复制属性。一般的 Xcopy 会重置只读属性。</span><br><span class="line">  /N           Creates copies by using the NTFS short file or directory names. /n is required when you copy files or directories from an NTFS volume to a FAT volume or when the FAT file system naming convention (that is, <span class="number">8.3</span> characters) is required on the Destination file system. The Destination file system can be FAT or NTFS./用生成的短名称复制。</span><br><span class="line">  /O           Copies file ownership and discretionary access control list (DACL) information./复制文件所有权和 ACL 信息。</span><br><span class="line">  /X           Copies file audit settings and system access control list (SACL) information (implies /o)./复制文件审核设置(隐含 /O)。</span><br><span class="line">  /Y           Suppresses prompting to confirm that you want to overwrite an existing destination file./取消提示以确认要覆盖现有目标文件。</span><br><span class="line">  /-Y          Prompts to confirm that you want to overwrite an existing destination file./要提示以确认要覆盖</span><br><span class="line">现有目标文件。</span><br><span class="line">  /Z           Copies over a network <span class="keyword">in</span> restartable mode./在可重新启动模式下复制网络文件。</span><br><span class="line">  /B           Copies the symbolic link instead of the files. This parameter was introduced <span class="keyword">in</span> Windows Vista®./复制符号链接本身与链接目标。</span><br><span class="line">  /J           Copies files without buffering. Recommended <span class="keyword">for</span> very large files. This parameter was added <span class="keyword">in</span> Windows Server <span class="number">2008</span> R2./复制时不使用缓冲的 I/O。推荐复制大文件时使用。</span><br><span class="line">  /?Displays help at the command prompt./在命令提示符中显示帮助</span><br></pre></td></tr></table></figure><h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><blockquote><ul><li>copy directories</li></ul></blockquote><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XCOPY D:\workspace\Demo D:\publish\Demo /E /Y /C /D</span><br></pre></td></tr></table></figure><blockquote><ul><li>copy file</li></ul></blockquote><figure class="highlight ps"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XCOPY D:\config\Demo\demo.config D:\publish\Demo\demo.config /Y</span><br></pre></td></tr></table></figure><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><blockquote><ul><li><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/xcopy" target="_blank" rel="noopener">Xopy</a></li></ul></blockquote><blockquote><ul><li><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/xcopy#BKMK_addref" target="_blank" rel="noopener">Additional</a></li></ul></blockquote>]]></content>
      
      
      <categories>
          
          <category> Windows Commands </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows Commands </tag>
            
            <tag> XCOPY </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Failed to load Msxmlsql.dll</title>
      <link href="/2018/07/16/Failed-to-load-Msxmlsql-dll/"/>
      <url>/2018/07/16/Failed-to-load-Msxmlsql-dll/</url>
      
        <content type="html"><![CDATA[<h1 id="Failed-to-load-Msxmlsql-dll"><a href="#Failed-to-load-Msxmlsql-dll" class="headerlink" title="Failed to load Msxmlsql.dll"></a>Failed to load Msxmlsql.dll</h1><ul><li>Solution：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\Microsoft SQL Server\100\Shared\msxmlsql.dll </span><br><span class="line">to</span><br><span class="line">C:\Program Files\Microsoft SQL Server\MSSQL10_50.[veeam-dbinstance]\MSSQL\Binn </span><br><span class="line"></span><br><span class="line">then copy &quot;msxmlsql.rll&quot; from </span><br><span class="line">C:\Program Files\Microsoft SQL Server\100\Shared\Resources\1033\msxmlsql.rll </span><br><span class="line">to</span><br><span class="line">C:\Program Files\Microsoft SQL Server\MSSQL10_50.[veeam-dbinstance]\MSSQL\Binn\Resources\1033</span><br><span class="line"></span><br><span class="line">Restart SQL Server Service</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Error </category>
          
          <category> SQL Server </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL Server </tag>
            
            <tag> SQL Server Error </tag>
            
            <tag> SQL Server 2008R2 </tag>
            
            <tag> Msxmlsql.dll </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SQL PadLeft</title>
      <link href="/2018/05/01/SQL%20PadLeft/"/>
      <url>/2018/05/01/SQL%20PadLeft/</url>
      
        <content type="html"><![CDATA[<h1 id="SQL-PadLeft"><a href="#SQL-PadLeft" class="headerlink" title="SQL PadLeft"></a>SQL PadLeft</h1><ul><li>SQL</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PRINT RIGHT(CAST(REPLICATE('0', LEN(no_start)) + CAST(no_start + (inventory - 1) AS VARCHAR(50)) AS VARCHAR(50)), LEN(no_start))</span><br><span class="line"></span><br><span class="line">PRINT RIGHT(CAST(REPLICATE('0', LEN('000001')) + CAST('000001' + (50 - 1) AS VARCHAR(50)) AS VARCHAR(50)), LEN('000001'))</span><br></pre></td></tr></table></figure><a id="more"></a><ul><li>Result<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">000050</span><br></pre></td></tr></table></figure></li></ul><hr><h2 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h2><ul><li>Test Sql</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">PRINT RIGHT(CAST(REPLICATE('0', LEN('000001')) + CAST('000001' + (50 - 1) AS VARCHAR(50)) AS VARCHAR(50)), LEN('000001'))</span><br><span class="line"></span><br><span class="line">PRINT REPLICATE('0',5)</span><br><span class="line"></span><br><span class="line">PRINT REPLICATE('0',5) + 123</span><br><span class="line"></span><br><span class="line">PRINT REPLICATE('0',5) + '123'</span><br><span class="line"></span><br><span class="line">PRINT REPLICATE('0',5) + STR(123)</span><br><span class="line"></span><br><span class="line">PRINT REPLICATE('0',5) + CAST(123 AS varchar(20))</span><br><span class="line"></span><br><span class="line">PRINT STR(123)</span><br><span class="line"></span><br><span class="line">PRINT STR(123,5,2)</span><br><span class="line"></span><br><span class="line">PRINT STR(12345678900)</span><br></pre></td></tr></table></figure><ul><li>Test Result</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">000050</span><br><span class="line">00000</span><br><span class="line">123</span><br><span class="line">00000123</span><br><span class="line">00000       123</span><br><span class="line">00000123</span><br><span class="line">        123</span><br><span class="line">123.0</span><br></pre></td></tr></table></figure><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><blockquote><p> C# <a href="https://msdn.microsoft.com/zh-cn/library/system.string.padleft.aspx" target="_blank" rel="noopener">PadLeft</a></p></blockquote><blockquote><p> SQL <a href="https://docs.microsoft.com/zh-cn/sql/t-sql/functions/replicate-transact-sql" target="_blank" rel="noopener">REPLICATE</a></p></blockquote><blockquote><p> SQL <a href="https://docs.microsoft.com/zh-cn/sql/t-sql/functions/str-transact-sql" target="_blank" rel="noopener">STR</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> SQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> REPLICATE </tag>
            
            <tag> C# </tag>
            
            <tag> PadLeft </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>README</title>
      <link href="/2018/05/01/README/"/>
      <url>/2018/05/01/README/</url>
      
        <content type="html"><![CDATA[<ul><li>I Will Show You</li></ul>]]></content>
      
      
      
    </entry>
    
  
  
</search>
